{"ast":null,"code":"const {\n  randomBytes\n} = require('crypto');\nconst {\n  createSecretKey\n} = require('../../help/key_object');\nconst base64url = require('../../help/base64url');\nconst {\n  THUMBPRINT_MATERIAL,\n  PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS,\n  KEY_MANAGEMENT_DECRYPT,\n  KEY_MANAGEMENT_ENCRYPT,\n  KEYOBJECT\n} = require('../../help/consts');\nconst Key = require('./base');\nconst OCT_PUBLIC = new Set();\nObject.freeze(OCT_PUBLIC);\nconst OCT_PRIVATE = new Set(['k']);\nObject.freeze(OCT_PRIVATE);\n\n// Octet sequence Key Type\nclass OctKey extends Key {\n  constructor() {\n    super(...arguments);\n    Object.defineProperties(this, {\n      kty: {\n        value: 'oct',\n        enumerable: true\n      },\n      length: {\n        value: this[KEYOBJECT] ? this[KEYOBJECT].symmetricKeySize * 8 : undefined\n      },\n      k: {\n        enumerable: false,\n        get() {\n          if (this[KEYOBJECT]) {\n            Object.defineProperty(this, 'k', {\n              value: base64url.encodeBuffer(this[KEYOBJECT].export()),\n              configurable: false\n            });\n          } else {\n            Object.defineProperty(this, 'k', {\n              value: undefined,\n              configurable: false\n            });\n          }\n          return this.k;\n        },\n        configurable: true\n      }\n    });\n  }\n  static get [PUBLIC_MEMBERS]() {\n    return OCT_PUBLIC;\n  }\n  static get [PRIVATE_MEMBERS]() {\n    return OCT_PRIVATE;\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL]() {\n    if (!this[KEYOBJECT]) {\n      throw new TypeError('reference \"oct\" keys without \"k\" cannot have their thumbprint calculated');\n    }\n    return {\n      k: this.k,\n      kty: 'oct'\n    };\n  }\n  [KEY_MANAGEMENT_ENCRYPT]() {\n    return new Set([...this.algorithms('wrapKey'), ...this.algorithms('deriveKey')]);\n  }\n  [KEY_MANAGEMENT_DECRYPT]() {\n    return this[KEY_MANAGEMENT_ENCRYPT]();\n  }\n  algorithms() {\n    if (!this[KEYOBJECT]) {\n      return new Set();\n    }\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return Key.prototype.algorithms.call(this, ...args);\n  }\n  static async generate() {\n    return this.generateSync(...arguments);\n  }\n  static generateSync() {\n    let len = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 256;\n    let privat = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    if (!privat) {\n      throw new TypeError('\"oct\" keys cannot be generated as public');\n    }\n    if (!Number.isSafeInteger(len) || !len || len % 8 !== 0) {\n      throw new TypeError('invalid bit length');\n    }\n    return createSecretKey(randomBytes(len / 8));\n  }\n}\nmodule.exports = OctKey;","map":{"version":3,"names":["randomBytes","require","createSecretKey","base64url","THUMBPRINT_MATERIAL","PUBLIC_MEMBERS","PRIVATE_MEMBERS","KEY_MANAGEMENT_DECRYPT","KEY_MANAGEMENT_ENCRYPT","KEYOBJECT","Key","OCT_PUBLIC","Set","Object","freeze","OCT_PRIVATE","OctKey","constructor","defineProperties","kty","value","enumerable","length","symmetricKeySize","undefined","k","get","defineProperty","encodeBuffer","export","configurable","TypeError","algorithms","args","prototype","call","generate","generateSync","len","privat","Number","isSafeInteger","module","exports"],"sources":["/Users/justinas/Documents/repos/microgogool/client/node_modules/jose/lib/jwk/key/oct.js"],"sourcesContent":["const { randomBytes } = require('crypto')\n\nconst { createSecretKey } = require('../../help/key_object')\nconst base64url = require('../../help/base64url')\nconst {\n  THUMBPRINT_MATERIAL, PUBLIC_MEMBERS, PRIVATE_MEMBERS,\n  KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT, KEYOBJECT\n} = require('../../help/consts')\n\nconst Key = require('./base')\n\nconst OCT_PUBLIC = new Set()\nObject.freeze(OCT_PUBLIC)\nconst OCT_PRIVATE = new Set(['k'])\nObject.freeze(OCT_PRIVATE)\n\n// Octet sequence Key Type\nclass OctKey extends Key {\n  constructor (...args) {\n    super(...args)\n    Object.defineProperties(this, {\n      kty: {\n        value: 'oct',\n        enumerable: true\n      },\n      length: {\n        value: this[KEYOBJECT] ? this[KEYOBJECT].symmetricKeySize * 8 : undefined\n      },\n      k: {\n        enumerable: false,\n        get () {\n          if (this[KEYOBJECT]) {\n            Object.defineProperty(this, 'k', {\n              value: base64url.encodeBuffer(this[KEYOBJECT].export()),\n              configurable: false\n            })\n          } else {\n            Object.defineProperty(this, 'k', {\n              value: undefined,\n              configurable: false\n            })\n          }\n\n          return this.k\n        },\n        configurable: true\n      }\n    })\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return OCT_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return OCT_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    if (!this[KEYOBJECT]) {\n      throw new TypeError('reference \"oct\" keys without \"k\" cannot have their thumbprint calculated')\n    }\n    return { k: this.k, kty: 'oct' }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return new Set([\n      ...this.algorithms('wrapKey'),\n      ...this.algorithms('deriveKey')\n    ])\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    return this[KEY_MANAGEMENT_ENCRYPT]()\n  }\n\n  algorithms (...args) {\n    if (!this[KEYOBJECT]) {\n      return new Set()\n    }\n\n    return Key.prototype.algorithms.call(this, ...args)\n  }\n\n  static async generate (...args) {\n    return this.generateSync(...args)\n  }\n\n  static generateSync (len = 256, privat = true) {\n    if (!privat) {\n      throw new TypeError('\"oct\" keys cannot be generated as public')\n    }\n    if (!Number.isSafeInteger(len) || !len || len % 8 !== 0) {\n      throw new TypeError('invalid bit length')\n    }\n\n    return createSecretKey(randomBytes(len / 8))\n  }\n}\n\nmodule.exports = OctKey\n"],"mappings":"AAAA,MAAM;EAAEA;AAAY,CAAC,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAEzC,MAAM;EAAEC;AAAgB,CAAC,GAAGD,OAAO,CAAC,uBAAuB,CAAC;AAC5D,MAAME,SAAS,GAAGF,OAAO,CAAC,sBAAsB,CAAC;AACjD,MAAM;EACJG,mBAAmB;EAAEC,cAAc;EAAEC,eAAe;EACpDC,sBAAsB;EAAEC,sBAAsB;EAAEC;AAClD,CAAC,GAAGR,OAAO,CAAC,mBAAmB,CAAC;AAEhC,MAAMS,GAAG,GAAGT,OAAO,CAAC,QAAQ,CAAC;AAE7B,MAAMU,UAAU,GAAG,IAAIC,GAAG,EAAE;AAC5BC,MAAM,CAACC,MAAM,CAACH,UAAU,CAAC;AACzB,MAAMI,WAAW,GAAG,IAAIH,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;AAClCC,MAAM,CAACC,MAAM,CAACC,WAAW,CAAC;;AAE1B;AACA,MAAMC,MAAM,SAASN,GAAG,CAAC;EACvBO,WAAW,GAAW;IACpB,KAAK,CAAC,YAAO,CAAC;IACdJ,MAAM,CAACK,gBAAgB,CAAC,IAAI,EAAE;MAC5BC,GAAG,EAAE;QACHC,KAAK,EAAE,KAAK;QACZC,UAAU,EAAE;MACd,CAAC;MACDC,MAAM,EAAE;QACNF,KAAK,EAAE,IAAI,CAACX,SAAS,CAAC,GAAG,IAAI,CAACA,SAAS,CAAC,CAACc,gBAAgB,GAAG,CAAC,GAAGC;MAClE,CAAC;MACDC,CAAC,EAAE;QACDJ,UAAU,EAAE,KAAK;QACjBK,GAAG,GAAI;UACL,IAAI,IAAI,CAACjB,SAAS,CAAC,EAAE;YACnBI,MAAM,CAACc,cAAc,CAAC,IAAI,EAAE,GAAG,EAAE;cAC/BP,KAAK,EAAEjB,SAAS,CAACyB,YAAY,CAAC,IAAI,CAACnB,SAAS,CAAC,CAACoB,MAAM,EAAE,CAAC;cACvDC,YAAY,EAAE;YAChB,CAAC,CAAC;UACJ,CAAC,MAAM;YACLjB,MAAM,CAACc,cAAc,CAAC,IAAI,EAAE,GAAG,EAAE;cAC/BP,KAAK,EAAEI,SAAS;cAChBM,YAAY,EAAE;YAChB,CAAC,CAAC;UACJ;UAEA,OAAO,IAAI,CAACL,CAAC;QACf,CAAC;QACDK,YAAY,EAAE;MAChB;IACF,CAAC,CAAC;EACJ;EAEA,YAAYzB,cAAc,IAAK;IAC7B,OAAOM,UAAU;EACnB;EAEA,YAAYL,eAAe,IAAK;IAC9B,OAAOS,WAAW;EACpB;;EAEA;EACA;EACA,CAACX,mBAAmB,IAAK;IACvB,IAAI,CAAC,IAAI,CAACK,SAAS,CAAC,EAAE;MACpB,MAAM,IAAIsB,SAAS,CAAC,0EAA0E,CAAC;IACjG;IACA,OAAO;MAAEN,CAAC,EAAE,IAAI,CAACA,CAAC;MAAEN,GAAG,EAAE;IAAM,CAAC;EAClC;EAEA,CAACX,sBAAsB,IAAK;IAC1B,OAAO,IAAII,GAAG,CAAC,CACb,GAAG,IAAI,CAACoB,UAAU,CAAC,SAAS,CAAC,EAC7B,GAAG,IAAI,CAACA,UAAU,CAAC,WAAW,CAAC,CAChC,CAAC;EACJ;EAEA,CAACzB,sBAAsB,IAAK;IAC1B,OAAO,IAAI,CAACC,sBAAsB,CAAC,EAAE;EACvC;EAEAwB,UAAU,GAAW;IACnB,IAAI,CAAC,IAAI,CAACvB,SAAS,CAAC,EAAE;MACpB,OAAO,IAAIG,GAAG,EAAE;IAClB;IAAC,kCAHYqB,IAAI;MAAJA,IAAI;IAAA;IAKjB,OAAOvB,GAAG,CAACwB,SAAS,CAACF,UAAU,CAACG,IAAI,CAAC,IAAI,EAAE,GAAGF,IAAI,CAAC;EACrD;EAEA,aAAaG,QAAQ,GAAW;IAC9B,OAAO,IAAI,CAACC,YAAY,CAAC,YAAO,CAAC;EACnC;EAEA,OAAOA,YAAY,GAA4B;IAAA,IAA1BC,GAAG,uEAAG,GAAG;IAAA,IAAEC,MAAM,uEAAG,IAAI;IAC3C,IAAI,CAACA,MAAM,EAAE;MACX,MAAM,IAAIR,SAAS,CAAC,0CAA0C,CAAC;IACjE;IACA,IAAI,CAACS,MAAM,CAACC,aAAa,CAACH,GAAG,CAAC,IAAI,CAACA,GAAG,IAAIA,GAAG,GAAG,CAAC,KAAK,CAAC,EAAE;MACvD,MAAM,IAAIP,SAAS,CAAC,oBAAoB,CAAC;IAC3C;IAEA,OAAO7B,eAAe,CAACF,WAAW,CAACsC,GAAG,GAAG,CAAC,CAAC,CAAC;EAC9C;AACF;AAEAI,MAAM,CAACC,OAAO,GAAG3B,MAAM"},"metadata":{},"sourceType":"script"}